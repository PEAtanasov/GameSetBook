@model AllReviewsPagingServiceModel
@inject IClubService clubservice;

@{
    ViewBag.Title = "All Reviews";
    bool isTheClubOwner = await clubservice.IsTheOwnerOfTheClubAsync(Model.ClubId, User.Id());
}

<h2 class="text-center">@Model.ClubName @ViewBag.Title</h2>

<div class="container">
    <div class="row">
        <div class="col-md-3">
            <div class="left-column">
                <!-- Left part: Render _ClubInfoPartial.cshtml -->
                <partial name="_ClubInfoPartial" model="Model.ClubInfo" />
                @if (!isTheClubOwner)
                {
                    <a asp-controller="Club" asp-action="Schedule" asp-route-id="@Model.ClubId" class="btn btn-primary mb-2 w-100 p-3 fw-bold">Book Now</a>
                }
            </div>
        </div>
        <div class="col-md-9">
            <!-- Right part: Display other club details -->
            @if (Model.Reviews.Any())
            {
                foreach (var review in Model.Reviews)
                {
                    <partial name="_ReviewDetailsPartial" model="@review" />
                }
            }
            else
            {
                <h4 class="text-center pb-3">The Club Has No Reviews</h4>
            }
        </div>
    </div>
</div>



@{
    var previousPage = Model.CurrentPage - 1;
    if (previousPage < 1)
    {
        previousPage = 1;
    }
    var maxPage = Math.Ceiling((double)Model.TotalReviewCount / Model.ReviewsPerPage);
}

<div class="d-flex justify-content-center mt-4">
    <nav>
        <ul class="pagination">
            <li class="page-item @(Model.CurrentPage == 1 ? "disabled" : string.Empty)">
                <a class="page-link"
                   asp-controller="Review"
                   asp-action="AllReviews"
                   asp-route-currentPage="@previousPage"
                   asp-route-clubId="@Model.ClubId">Previous</a>
            </li>

            @for (int i = 1; i <= maxPage; i++)
            {
                <li class="page-item">
                    <a class="page-link @(Model.CurrentPage == i ? "active" : string.Empty)"
                       asp-controller="Review"
                       asp-action="AllReviews"
                       asp-route-currentPage="@i"
                       asp-route-clubId="@Model.ClubId">
                        @i
                    </a>
                </li>
            }

            @{
                var shouldButtonBeDisabled = Model.CurrentPage == maxPage ||
                !Model.Reviews.Any();
            }

            <li class="page-item @(shouldButtonBeDisabled ? "disabled" : string.Empty)">
                <a class="page-link"
                   asp-controller="Review"
                   asp-action="AllReviews"
                   asp-route-currentPage="@(Model.CurrentPage+1)"
                   asp-route-clubId="@Model.ClubId">Next</a>
            </li>
        </ul>
    </nav>
</div>



